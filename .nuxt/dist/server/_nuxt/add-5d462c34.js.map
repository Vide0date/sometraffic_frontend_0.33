{"version":3,"file":"add-5d462c34.js","sources":["../../../../pages/projects/add.vue"],"sourcesContent":["<template>\r\n  <div @click.shift=\"doSomething\">\r\n    <div id=\"last-tracking-url\">\r\n      <Modal\r\n        title=\"Are you sure?\"\r\n        modalClass=\"confirm-modal\"\r\n        v-model:visible=\"shouldShowDialog\"\r\n        :cancelButton=\"{ text: 'Cancel' }\"\r\n        :okButton=\"{ text: 'Okay', onclick: () => handleSave() }\"\r\n      >\r\n        <div class=\"text\">\r\n          This item already exists in the database. Are you sure that you want\r\n          to create it double?\r\n        </div>\r\n      </Modal>\r\n\r\n      <form @submit.prevent=\"createProject\">\r\n        <div class=\"flex justify-between\">\r\n          <h1 class=\"font-bold py-4 capitalize\">Add a new project</h1>\r\n\r\n          <button\r\n            type=\"submit\"\r\n            class=\"bg-[#bcbcbc] inline-flex justify-center rounded-md border border-transparent pt-4 px-4 text-sm font-medium text-black shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\"\r\n          >\r\n            Add project\r\n          </button>\r\n        </div>\r\n\r\n        <div class=\"overflow-hidden shadow sm:rounded-md\">\r\n          <div class=\"px-4 py-5 sm:p-6\">\r\n            <div class=\"col-span-12\">\r\n              <div class=\"grid grid-cols-12\">\r\n                <div\r\n                  class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\r\n                >\r\n                  ID\r\n                </div>\r\n                <div class=\"col-span-3\">\r\n                  <input\r\n                    type=\"text\"\r\n                    v-model=\"form.unique_identifier\"\r\n                    :disabled=\"form.unique_identifier\"\r\n                    id=\"item_id\"\r\n                    class=\"bg-[#dddddd] disabled:bg-gray-300 disabled:text-gray-500 h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                    required\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"flex flex-row mt-4\">\r\n              <div class=\"basis-1/2 pr-1.5\">\r\n                <div class=\"col-span-12\">\r\n                  <div class=\"grid grid-cols-12\">\r\n                    <div\r\n                      class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\r\n                    >\r\n                      Created\r\n                    </div>\r\n                    <div class=\"col-span-9\">\r\n                      <input\r\n                        type=\"text\"\r\n                        v-model=\"form.timestamp\"\r\n                        :disabled=\"form.timestamp\"\r\n                        id=\"timestamp\"\r\n                        class=\"bg-[#dddddd] disabled:bg-gray-300 disabled:text-gray-500 h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"basis-1/2 pl-1.5\">\r\n                <div class=\"col-span-12\">\r\n                  <div class=\"grid grid-cols-12\">\r\n                    <div\r\n                      class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\r\n                    >\r\n                      Created By\r\n                    </div>\r\n                    <div class=\"col-span-9\">\r\n                      <input\r\n                        type=\"text\"\r\n                        v-model=\"form.createdBy\"\r\n                        :disabled=\"form.createdBy\"\r\n                        id=\"username\"\r\n                        class=\"bg-[#dddddd] disabled:bg-gray-300 disabled:text-gray-500 h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"col-span-12 mt-4\">\r\n              <div class=\"grid grid-cols-12\">\r\n                <div\r\n                  class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\r\n                >\r\n                  Project name *\r\n                </div>\r\n                <div class=\"col-span-3\">\r\n                  <input\r\n                    placeholder=\"Need to enter account name (obligatory)\"\r\n                    type=\"text\"\r\n                    v-model=\"form.name\"\r\n                    id=\"name\"\r\n                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div\r\n                  class=\"col-span-6 pl-4\"\r\n                >\r\n                  <div class=\"col-span-12\">\r\n                    <div class=\"grid grid-cols-12\">\r\n                      <div\r\n                        class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\r\n                      >\r\n                        Account\r\n                      </div>\r\n                      <div class=\"col-span-9\">\r\n                        <input\r\n                          type=\"text\"\r\n                          :value=\"activeAccountData.name\"\r\n                          :disabled=\"activeAccountData.name\"\r\n                          id=\"username\"\r\n                          class=\"bg-[#dddddd] disabled:bg-gray-300 disabled:text-gray-500 h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                          required\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"col-span-12 sm:col-span-12 mt-4\">\r\n              <div\r\n                class=\"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-1 xl:grid-cols-12 gap-4 gap-x-4\"\r\n              >\r\n                <div class=\"col-span-12 sm:col-span-12\">\r\n                  <label\r\n                    for=\"description\"\r\n                    class=\"block text-sm font-medium text-gray-700\"\r\n                    >Description</label\r\n                  >\r\n                  <textarea\r\n                    v-model=\"form.description\"\r\n                    rows=\"6\"\r\n                    id=\"description\"\r\n                    class=\"bg-[#dddddd] py-2 px-3 text-gray-900 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                    placeholder=\"(free text field, 1000 characters max, about 30 sentenses max) what is the goal of this item or project\"\r\n                  ></textarea>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- <div class=\"px-4 py-3 text-right sm:px-6 w-full sm:w-full\">\r\n              <button\r\n                type=\"submit\"\r\n                class=\"bg-[#bcbcbc] inline-flex justify-center rounded-md border border-transparent py-2 px-4 text-sm font-medium text-black shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\"\r\n              >\r\n                Create category item\r\n              </button>\r\n            </div> -->\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\ninput:checked {\r\n  background-color: #22c55e; /* bg-green-500 */\r\n}\r\n\r\ninput:checked ~ span:last-child {\r\n  --tw-translate-x: 1.75rem; /* translate-x-7 */\r\n}\r\n.valid {\r\n  border: 3px solid green;\r\n}\r\n\r\n.invalid {\r\n  border: 3px solid red;\r\n}\r\n\r\n#awn-popup-wrapper {\r\n  display: none !important;\r\n}\r\n\r\n.input-w-loading {\r\n  width: 90%;\r\n}\r\nimg.loading {\r\n  width: 50px;\r\n  display: inline-block;\r\n  margin-left: 10px;\r\n}\r\n</style>\r\n\r\n<script setup>\r\nimport { Modal } from \"usemodal-vue3\"\r\ndefinePageMeta({\r\n  middleware: [\"auth\"],\r\n})\r\nconst AWN = inject(\"$awn\")\r\nconst config = useRuntimeConfig()\r\n\r\nconst shouldShowDialog = ref(false)\r\nconst clickdatas = ref([])\r\nconst activeAccount = ref(\r\n  localStorage.getItem(\"activeAccount\")\r\n)\r\nconst activeAccountData = ref(\r\n  JSON.parse(localStorage.getItem(\"activeAccountData\"))\r\n)\r\n// const defUser = JSON.parse(localStorage.getItem(\"user\"));\r\nlet defaultCategory = localStorage.getItem(\"sometraffic_default_category\")\r\nlet defaultGroup = localStorage.getItem(\"sometraffic_default_group\")\r\nlet defaultPriority = localStorage.getItem(\"sometraffic_default_priority\")\r\nlet user = localStorage.getItem(\"user\")\r\n\r\nlet timestamp = new Date().toLocaleTimeString()\r\n\r\nconst uniqueUrl = ref(\"\")\r\nconst isLoading = ref(false)\r\n\r\nsetInterval(() => {\r\n  timestamp = new Date().toLocaleTimeString()\r\n}, 10)\r\n\r\nfunction isValidUrl(urlString) {\r\n  let urlPattern = new RegExp(\r\n    \"^(https?:\\\\/\\\\/)?\" + // validate protocol\r\n      \"((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|\" + // validate domain name\r\n      \"((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))\" + // validate OR ip (v4) address\r\n      \"(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*\" + // validate port and path\r\n      \"(\\\\?[;&a-z\\\\d%_.~+=-]*)?\" + // validate query string\r\n      \"(\\\\#[-a-z\\\\d_]*)?$\",\r\n    \"i\"\r\n  ) // validate fragment locator\r\n\r\n  return !!urlPattern.test(urlString)\r\n}\r\n\r\nconst form = reactive({\r\n  name: \"\",\r\n  description: \"\",\r\n  unique_identifier: \"\",\r\n  timestamp,\r\n  createdBy: JSON.parse(user).userName,\r\n})\r\n\r\nconst createProject = async () => {\r\n  const a_data = {\r\n    AccountId: activeAccount.value,\r\n    createdBy: form.createdBy,\r\n    unique_identifier: form.unique_identifier,\r\n    name: form.name,\r\n    description: form.description,\r\n  }\r\n  await useFetch(`${config.API_BASE_URL}projects/create`, {\r\n    method: \"POST\",\r\n    body: a_data,\r\n  })\r\n    .then((result) => {\r\n      if (result.data.value) {\r\n        AWN.success(result.data.value.message)\r\n        uniqueUrl.value = \"\"\r\n        navigateTo(\"/projects\").then(() => {\r\n          const router = useRouter()\r\n          router.go(\"/projects\")\r\n        })\r\n      }\r\n      if (result.error.value) {\r\n        console.log(\"error value1\", result.error.value.data.message)\r\n        AWN.alert(error)\r\n      }\r\n    })\r\n    .catch((error) => {\r\n      console.log(\"error value\", error)\r\n      AWN.alert(\"Unable to create item.\")\r\n    })\r\n}\r\n\r\n//   const handleSave = async () => {\r\n//     let a_data = {\r\n//       AccountId: form.AccountId,\r\n//       timestamp: new Date(),\r\n//       name: form.name,\r\n//       unique_identifier: form.item_id,\r\n//       description: form.description,\r\n//       category: form.category,\r\n//       priority: form.priority,\r\n//       cat_group: form.group,\r\n//       visibility: form.visibility,\r\n//       url_1_link: form.url_1_link,\r\n//       url_2_txt: form.url_2_txt,\r\n//       url_2_link: form.url_2_link,\r\n//       plan_frequency: form.plan_frequency,\r\n//       automatic_status: form.automatic_status,\r\n//     }\r\n\r\n//     await useFetch(`${config.API_BASE_URL}projects/create`, {\r\n//       method: \"POST\",\r\n//       body: a_data,\r\n//     })\r\n//       .then((result) => {\r\n//         if (result.data.value) {\r\n//           AWN.success(result.data.value.message)\r\n//           uniqueUrl.value = \"\"\r\n//           navigateTo(\"/projects\")\r\n//         }\r\n//         if (result.error.value) {\r\n//           console.log(\"error value1\", result.error.value.data.message)\r\n//           shouldShowDialog.value = false\r\n//           AWN.alert(error)\r\n//         }\r\n//       })\r\n//       .catch((error) => {\r\n//         console.log(\"error value\", error)\r\n//         AWN.alert(\"Validation error\")\r\n//       })\r\n//   }\r\n\r\nconst getTrackingURL = async () => {\r\n  const { data, error } = await useFetch(\r\n    `${config.API_BASE_URL}projects/gettrackingurl`\r\n  )\r\n  if (data.value) {\r\n    form.unique_identifier = data.value.newTrackingURl\r\n  }\r\n  if (error.value) {\r\n    await AWN.alert(error.value.statusMessage)\r\n  }\r\n}\r\n\r\nonBeforeMount(getTrackingURL)\r\n\r\n// onMounted(() => {\r\n//   document.addEventListener(\"keydown\", (event) => {\r\n//     // event.keyCode or event.which  property will have the code of the pressed key\r\n//     let keyCode = event.keyCode ? event.keyCode : event.which;\r\n\r\n//     // 13 points the enter key, 16 points the shift key\r\n//     if (event.altKey && keyCode === 67) {\r\n//       getTrackingURL();\r\n\r\n//       form.AccountId = JSON.parse(user).AccountId;\r\n//       form.timestamp = new Date().toLocaleTimeString();\r\n//       form.description = \"\";\r\n//       form.category = \"\";\r\n//       form.name = \"\";\r\n\r\n//       form.group = \"all\";\r\n//       form.priority = \"\";\r\n//       form.visibility = \"low\";\r\n//       form.url_1_link = \"\";\r\n//       form.url_2_txt = \"\";\r\n//       form.url_2_link = \"\";\r\n//       form.plan_frequency = \"\";\r\n//       form.automatic_status = \"\";\r\n//     }\r\n//   });\r\n// });\r\n</script>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAiNA,WAAA,MAAA;AACA,qBAAA;AAEA,UAAA,mBAAA,IAAA,KAAA;AACA,QAAA,EAAA;AACA;AAAA,MACA,aAAA,QAAA,eAAA;AAAA,IACA;AACA,UAAA,oBAAA;AAAA,MACA,KAAA,MAAA,aAAA,QAAA,mBAAA,CAAA;AAAA,IACA;AAEA,iBAAA,QAAA,8BAAA;AACA,iBAAA,QAAA,2BAAA;AACA,iBAAA,QAAA,8BAAA;AACA,QAAA,OAAA,aAAA,QAAA,MAAA;AAEA,QAAA,YAAA,IAAA,KAAA,EAAA,mBAAA;AAEA,QAAA,EAAA;AACA,QAAA,KAAA;AAEA,gBAAA,MAAA;AACA,kBAAA,IAAA,KAAA,EAAA,mBAAA;AAAA,IACA,GAAA,EAAA;AAgBA,UAAA,OAAA,SAAA;AAAA,MACA,MAAA;AAAA,MACA,aAAA;AAAA,MACA,mBAAA;AAAA,MACA;AAAA,MACA,WAAA,KAAA,MAAA,IAAA,EAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
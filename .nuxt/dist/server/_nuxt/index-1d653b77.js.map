{"version":3,"file":"index-1d653b77.js","sources":["../../../../pages/emails/index.vue"],"sourcesContent":["<template>\n    <div>\n\n        <div id=\"last-users\">\n            <h1 class=\"font-bold py-4 uppercase\">Admin email setting</h1>\n            <form v-on:submit.prevent>\n                <div class=\"overflow-hidden shadow sm:rounded-md\">\n                    <div class=\"px-4 py-5 sm:p-6\">\n\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Email\n                                address</div>\n                            <div class=\"basis-1/2\"> <input type=\"text\" v-model=\"form.email\" id=\"email\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required /></div>\n                        </div>\n\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Password</div>\n                            <div class=\"basis-1/2\">\n                                <input type=\"text\" v-model=\"form.password\" id=\"password\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required />\n                            </div>\n                        </div>\n\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">From Name (Sender)\n                            </div>\n                            <div class=\"basis-1/2\">\n                                <input type=\"text\" v-model=\"form.sender\" id=\"sender\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required />\n                            </div>\n                        </div>\n\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Incoming Mail Server\n                            </div>\n                            <div class=\"basis-1/2\">\n                                <input type=\"text\" v-model=\"form.incoming_mail\" id=\"incoming_mail\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required />\n                            </div>\n                        </div>\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Outgoing Mail Server\n                            </div>\n                            <div class=\"basis-1/2\">\n                                <input type=\"text\" v-model=\"form.outgoing_mail\" id=\"outgoing_mail\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required />\n                            </div>\n                        </div>\n\n\n                        <!-- FOR SSL/TLS -->\n                        <div class=\"s_ssl pt-2\">\n                            <p class=\" text-sm font-medium text-gray-700\">FOR SSL/TLS</p>\n                            <div\n                                class=\"col-span-12 sm:col-span-12 rounded-md border-solid border-2 border-[#cbd5e1] shadow-sm\">\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Imap</div>\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"number\" v-model=\"form.s_imap_port\" id=\"s_imap_port\"\n                                            class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                            required />\n                                    </div>\n                                </div>\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Pop3</div>\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"number\" v-model=\"form.s_pop3_port\" id=\"s_pop3_port\"\n                                            class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                            required />\n                                    </div>\n                                </div>\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Smtp</div>\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"number\" v-model=\"form.s_smtp_port\" id=\"s_smtp_port\"\n                                            class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                            required />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        <!-- FOR NON-SSL/TLS -->\n                        <div class=\"n_ssl pt-2 \">\n                            <p class=\" text-sm font-medium text-gray-700\">FOR None-SSL/TLS</p>\n                            <div\n                                class=\"col-span-12 sm:col-span-12 rounded-md border-solid border-2 border-[#cbd5e1] shadow-sm\">\n\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Imap</div>\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"number\" v-model=\"form.n_imap_port\" id=\"n_imap_port\"\n                                            class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                            required />\n                                    </div>\n                                </div>\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Pop3</div>\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"number\" v-model=\"form.n_pop3_port\" id=\"n_pop3_port\"\n                                            class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                            required />\n                                    </div>\n                                </div>\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Smtp</div>\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"number\" v-model=\"form.n_smtp_port\" id=\"n_smtp_port\"\n                                            class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                            required />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Webmail url</div>\n                            <div class=\"basis-1/2\">\n                                <input type=\"text\" v-model=\"form.webmail_url\" id=\"webmail_url\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required />\n                            </div>\n                        </div>\n\n                        <div class=\"flex flex-row py-2\">\n                            <div class=\"basis-1/4 flex items-center text-sm font-medium text-gray-700\">Technical information\n                            </div>\n                            <div class=\"basis-1/2\">\n                                <input type=\"text\" v-model=\"form.technical_information\" id=\"technical_information\"\n                                    class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-2/3 rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required />\n                            </div>\n                        </div>\n\n\n                        <div class=\"grid grid-cols-12 gap-12\">\n                            <div class=\"col-span-12 sm:col-span-12\">\n                                <label for=\"information\" class=\"block text-sm font-medium text-gray-700\">Information</label>\n                                <textarea v-model=\"form.information\" rows=\"6\" id=\"information\"\n                                    class=\"bg-[#dddddd] py-2 px-3 text-gray-900 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                                    required></textarea>\n                            </div>\n\n\n\n                        </div>\n\n                        <div class=\"flex justify-between pb-3 pt-5\">\n                                <a href=\"https://sometraffic.com/manuals/login-to-webmail.pdf\" target=\"_blank\"\n                                    class=\"decoration-solid underline text-gray-800 flex\">Login to webmail instructions \n                                    <svg v-tooltip.right=\"{ content: '<div>You can download the login webmail manual through this link!</div>', html: true }\"\n                                    xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\"\n                                    stroke=\"currentColor\" class=\"w-6 h-6 ml-2\">\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\n                                        d=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\" />\n                                </svg>\n                                </a>\n                                \n\n                            <button type=\"button\" :disabled=\"form.id == ''\" @click.prevent=\"(event) => update(form.id)\"\n                                class=\"bg-[#bcbcbc] inline-flex justify-center rounded-md border border-transparent py-2 px-4 text-sm font-medium text-gray-800 shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\">Update\n                                Email Setting</button>\n                        </div>\n\n                        <div class=\"flex justify-between py-2\">\n                            <a href=\"https://sometraffic.com/manuals/reset-email-password.pdf\" target=\"_blank\"\n                                class=\"decoration-solid underline text-gray-800 flex\">Reset email password instructions\n                                <svg v-tooltip.right=\"{ content: '<div>You can download the reset email password manual through this link!</div>', html: true }\"\n                                    xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\"\n                                    stroke=\"currentColor\" class=\"w-6 h-6 ml-2\">\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\n                                        d=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\" />\n                                </svg>\n                            </a>\n                            <button @click.prevent=\"addEmail\"\n                                :disabled=\"form.id != '' || !form.email || !form.s_smtp_port || !form.password\"\n                                class=\"bg-[#bcbcbc] inline-flex justify-center rounded-md border border-transparent py-2 px-4 text-sm font-medium text-gray-800 shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\">Save\n                                Email Setting</button>\n                        </div>\n\n                        <div class=\"grid grid-cols-12 gap-12 py-2\">\n                            <div class=\"col-span-12 sm:col-span-12\">\n                                <a href=\"https://sometraffic.com/manuals/email-error-log.pdf\" target=\"_blank\"\n                                    class=\"decoration-solid underline text-gray-800 flex\">Email error log \n                                    <svg v-tooltip.right=\"{ content: '<div>You can download the email error log through this link!</div>', html: true }\"\n                                    xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\"\n                                    stroke=\"currentColor\" class=\"w-6 h-6 ml-2\">\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\"\n                                        d=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\" />\n                                </svg>\n                                </a>\n                            </div>\n                        </div>\n\n                        <p class=\"col-span-12 sm:col-span-12 py-2 text-gray-800\">Sent a test email here: </p>\n\n                         \n                        <div class=\"grid grid-cols-12 gap-12 py-2\">\n                            <div class=\"col-span-12 sm:col-span-12\">\n                                <label for=\"testmail\" class=\"block text-sm font-medium text-gray-700\">What email address\n                                    should receive the test email?</label>\n\n                                <div class=\"flex flex-row py-2\">\n                                    <div class=\"basis-1/2\">\n                                        <input type=\"text\" v-model=\"form.testmail\" id=\"testmail\"\n                                            class=\"bg-[#dddddd] py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\" />\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"px-4 py-3 text-left sm:px-6\">\n                        <button type=\"button\" @click.prevent=\"sendTestMail\" :disabled=\"form.testmail == ''\"\n                            class=\"bg-[#bcbcbc] inline-flex justify-center rounded-md border border-transparent py-2 px-4 text-sm font-medium text-gray-800 shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\">Send\n                            test email</button>\n                        <span class=\"inline-flex \" v-if=\"flaq.mail_send_flaq\">\n                            <Loader />\n                        </span>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</template>\n\n<script setup>\n\ndefinePageMeta({\n    middleware: [\"auth\", \"admin\"],\n})\nconst AWN = inject(\"$awn\");\nconst config = useRuntimeConfig();\nconst flaq = reactive({ mail_send_flaq: false });\nconst form = reactive({\n    id: '',\n    email: '',\n    password: '',\n    sender: '',\n    incoming_mail: '',\n    outgoing_mail: '',\n    s_imap_port: '',\n    s_pop3_port: '',\n    s_smtp_port: '',\n    n_imap_port: '',\n    n_pop3_port: '',\n    n_smtp_port: '',\n    webmail_url: '',\n    technical_information: '',\n    information: '',\n    testmail: ''\n\n})\n\nconst addEmail = async () => {\n    let em_data = {\n        id: form.id,\n        email: form.email,\n        password: form.password,\n        sender: form.sender,\n        incoming_mail: form.incoming_mail,\n        outgoing_mail: form.outgoing_mail,\n        s_imap_port: form.s_imap_port,\n        s_pop3_port: form.s_pop3_port,\n        s_smtp_port: form.s_smtp_port,\n        n_imap_port: form.n_imap_port,\n        n_pop3_port: form.n_pop3_port,\n        n_smtp_port: form.n_smtp_port,\n        webmail_url: form.webmail_url,\n        technical_information: form.technical_information,\n        information: form.information,\n        testmail: form.testmail\n    };\n\n    const { data, error } = await useFetch(`${config.API_BASE_URL}mail/create`, {\n        method: 'POST',\n        body: em_data\n    });\n    if (data.value) {\n        // console.log('data value', data.value.message);\n        await AWN.success(data.value.message);\n    }\n    if (error.value) {\n        await AWN.alert(error.value.statusMessage);\n    }\n    // console.log('form value inside add Email', form)\n    // location.assign('/mails')\n}\n\n\n\nconst setMail = async () => {\n    const { data, error } = await useFetch(`${config.API_BASE_URL}mail/all`)\n    // mails.value = data.value\n    if (data.value) {\n        // console.log('data.value.length()', );\n        let obj = data.value[0];\n\n        if (obj) {\n            form.id = obj.id;\n            form.email = obj.email;\n            form.password = obj.password;\n            form.sender = obj.sender;\n            form.incoming_mail = obj.incoming_mail;\n            form.outgoing_mail = obj.outgoing_mail;\n            form.s_imap_port = obj.s_imap_port;\n            form.s_pop3_port = obj.s_pop3_port;\n            form.s_smtp_port = obj.s_smtp_port;\n            form.n_imap_port = obj.n_imap_port;\n            form.n_pop3_port = obj.n_pop3_port;\n            form.n_smtp_port = obj.n_smtp_port;\n            form.webmail_url = obj.webmail_url;\n            form.technical_information = obj.technical_information;\n            form.information = obj.information;\n        }\n    }\n    if (error.value) {\n        await AWN.alert(error.value.statusMessage);\n    }\n}\nonBeforeMount(setMail);\n// onMounted(setMail)\n\nconst update = async (id) => {\n    // console.log('form id inside update func', id)\n    let em_up_data = {\n        id: form.id,\n        email: form.email,\n        password: form.password,\n        sender: form.sender,\n        incoming_mail: form.incoming_mail,\n        outgoing_mail: form.outgoing_mail,\n        s_imap_port: form.s_imap_port,\n        s_pop3_port: form.s_pop3_port,\n        s_smtp_port: form.s_smtp_port,\n        n_imap_port: form.n_imap_port,\n        n_pop3_port: form.n_pop3_port,\n        n_smtp_port: form.n_smtp_port,\n        webmail_url: form.webmail_url,\n        technical_information: form.technical_information,\n        information: form.information,\n        testmail: form.testmail\n    };\n    const { data, error } = await useFetch(`${config.API_BASE_URL}mail/update/${id}`, {\n        method: 'PUT',\n        params: { id: id },\n        body: em_up_data\n    })\n    if (data.value) {\n        // console.log('data value', data.value.message);\n        await AWN.success(data.value.message);\n    }\n    if (error.value) {\n        await AWN.alert(error.value.statusMessage);\n    }\n    await setMail()\n    // alert('you successfully updated admin email setting!');\n}\n\nconst sendTestMail = async () => {\n    flaq.mail_send_flaq = !flaq.mail_send_flaq;\n    // console.log('mail_send_flaq', flaq.mail_send_flaq);\n    // console.log('before prevent default send test mail ', form.id)\n    // e.preventDefault();\n    // console.log('after send test mail ', form.id)\n    let mail_data = {\n        id: form.id,\n        email: form.email,\n        password: form.password,\n        sender: form.sender,\n        incoming_mail: form.incoming_mail,\n        outgoing_mail: form.outgoing_mail,\n        s_imap_port: form.s_imap_port,\n        s_pop3_port: form.s_pop3_port,\n        s_smtp_port: form.s_smtp_port,\n        n_imap_port: form.n_imap_port,\n        n_pop3_port: form.n_pop3_port,\n        n_smtp_port: form.n_smtp_port,\n        webmail_url: form.webmail_url,\n        technical_information: form.technical_information,\n        information: form.information,\n        testmail: form.testmail\n    };\n    const { data, error } = await useFetch(`${config.API_BASE_URL}mail/sendmail`, {\n        method: 'POST',\n        body: mail_data\n    });\n    if (data.value) {\n        await AWN.success('Your testing mail successfully send!');\n        flaq.mail_send_flaq = !flaq.mail_send_flaq;\n    }\n    if (error.value) {\n        // alert('Error: '+error.value.statusMessage);\n        await AWN.alert(error.value.statusMessage);\n        flaq.mail_send_flaq = !flaq.mail_send_flaq;\n        // console.log('response error', error.value.statusMessage);\n    }\n\n}\n\n</script>\n\n<style scoped>\nbody.no-scroll {\n  overflow: hidden;\n}\n\n.v-popper__popper--no-positioning {\n  position: fixed;\n  z-index: 9999;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: flex-end;\n}\n\n.v-popper__popper--no-positioning .v-popper__backdrop {\n  display: block;\n  background: rgba(0 0 0 / 90%);\n}\n\n.v-popper__popper--no-positioning .v-popper__wrapper {\n  width: 100%;\n  pointer-events: auto;\n  transition: transform .15s ease-out;\n}\n\n.v-popper__popper--no-positioning.v-popper__popper--hidden .v-popper__wrapper {\n  transform: translateY(100%);\n}\n</style>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAmPA,WAAA,MAAA;AACA,qBAAA;AACA,UAAA,OAAA,SAAA,EAAA,gBAAA,MAAA,CAAA;AACA,UAAA,OAAA,SAAA;AAAA,MACA,IAAA;AAAA,MACA,OAAA;AAAA,MACA,UAAA;AAAA,MACA,QAAA;AAAA,MACA,eAAA;AAAA,MACA,eAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,uBAAA;AAAA,MACA,aAAA;AAAA,MACA,UAAA;AAAA,IAEA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
{"version":3,"file":"index-5f580ac1.js","sources":["../../../../pages/user-groups/index.vue"],"sourcesContent":["<template>\n  <div id=\"users_groups\">\n    <Modal\n      title=\"You can NOT undo this action\"\n      modalClass=\"confirm-modal\"\n      v-model:visible=\"shouldShowDialog\"\n      :cancelButton=\"{ text: 'Cancel' }\"\n      :okButton=\"{ text: 'Okay', onclick: () => handleDelete() }\"\n    >\n      <div class=\"text\">Are you sure you want to delete {{ name }}?</div>\n    </Modal>\n    <div class=\"flex justify-between\">\n      <h1 class=\"font-bold py-4 capitalize\">Groups list ({{ groupsTotal }})</h1>\n      <div class=\"flex items-start\">\n        <div class=\"flex border-2 rounded\">\n          <div class=\"relative\">\n            <input\n              type=\"text\"\n              v-model=\"search.vaClDa\"\n              class=\"px-4 py-2 w-80 border-inherit bg-inherit pr-9 focus:outline-none focus:ring focus:border-blue-600 search\"\n              placeholder=\"Search...\"\n              v-on:keyup.enter=\"enterSearch()\"\n            />\n            <!-- <div class=\"absolute inset-y-0 right-0\"> -->\n            <button\n              class=\"absolute inset-y-0 right-0 px-2\"\n              @click=\"(event) => empty()\"\n            >\n              <svg\n                color=\"black\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                stroke-width=\"1.5\"\n                stroke=\"currentColor\"\n                class=\"w-6 h-6\"\n              >\n                <path\n                  stroke-linecap=\"round\"\n                  stroke-linejoin=\"round\"\n                  d=\"M6 18L18 6M6 6l12 12\"\n                />\n              </svg>\n            </button>\n            <!-- </div> -->\n          </div>\n\n          <button\n            class=\"flex items-center justify-center px-4 border-l bg-blue-700\"\n            @click=\"(event) => searched()\"\n          >\n            <svg\n              class=\"w-6 h-6 text-slate-50\"\n              fill=\"currentColor\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                d=\"M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z\"\n              />\n            </svg>\n          </button>\n          <button\n            class=\"flex items-center justify-center px-4 border-l border-grey-600 bg-grey-700\"\n            @click=\"navigateTo('/user-groups/add')\"\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke-width=\"1.5\"\n              stroke=\"currentColor\"\n              class=\"w-6 h-6\"\n            >\n              <path\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n                d=\"M12 4.5v15m7.5-7.5h-15\"\n              />\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>\n    <div class=\"overflow-hidden shadow sm:rounded-md\">\n      <div class=\"px-4 py-5 sm:p-6\">\n        <div class=\"grid grid-cols-12\">\n          <!-- <div class=\"col-span-12\">\n            <form @submit.prevent=\"createUserGroup\">\n              <div class=\"grid\">\n                <div class=\"col-span-12\">\n                  <div class=\"grid grid-cols-12\">\n                    <div\n                      class=\"col-span-3 w-fit flex items-center text-sm font-medium text-gray-700\"\n                    >\n                      Name\n                    </div>\n                    <div class=\"col-span-9 px-1.5\">\n                      <input\n                        type=\"text\"\n                        v-model=\"form.name\"\n                        id=\"name\"\n                        maxlength=\"100\"\n                        class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                      />\n                    </div>\n                  </div>\n\n                  <div class=\"grid grid-cols-12\">\n                    <div\n                      class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\n                    >\n                      Description\n                    </div>\n                    <div class=\"col-span-9 px-1.5\">\n                      <textarea\n                        v-model=\"form.description\"\n                        id=\"description\"\n                        rows=\"6\"\n                        maxlength=\"500\"\n                        class=\"bg-[#dddddd] h-20 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\n                      ></textarea>\n                    </div>\n                  </div>\n\n                  <div class=\"px-2 py-3 text-right sm:px-2 w-full sm:w-full\">\n                    <button\n                      type=\"submit\"\n                      class=\"bg-[#bcbcbc] inline-flex justify-end rounded-md border border-transparent py-2 px-4 text-sm font-medium text-black shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\"\n                    >\n                      Submit\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div> -->\n          <div class=\"col-span-12\">\n            <div class=\"overflow-x-auto\">\n              <table class=\"w-full whitespace-nowrap\">\n                <thead class=\"bg-black/60\">\n                  <tr>\n                    <th class=\"text-left py-3 px-2 rounded-l-lg\">ID</th>\n                    <th class=\"text-left py-3 px-2\">Name</th>\n                    <th class=\"text-left py-3 px-2\">Description</th>\n                    <th class=\"text-left py-3 px-2 rounded-r-lg\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr\n                    class=\"border-b border-gray-700\"\n                    v-for=\"group in searchdatas\"\n                    :key=\"group.id\"\n                  >\n                    <td class=\"py-3 px-2\">\n                      <NuxtLink\n                        :to=\"`/user-groups/${group.unique_identifier}`\"\n                        title=\"Edit\"\n                        class=\"hover:text-white\"\n                      >\n                        {{ group?.unique_identifier }}\n                      </NuxtLink>\n                    </td>\n\n                    <td class=\"py-3 px-2\">{{ group.name }}</td>\n                    <td class=\"py-3 px-2\">\n                      {{\n                        group.description?.length > 100\n                          ? group.description.slice(0, 100) + \"...\"\n                          : group.description\n                      }}\n                    </td>\n                    <td class=\"py-3 px-2\">\n                      <div class=\"inline-flex items-center space-x-3\">\n                        <NuxtLink\n                          :to=\"`/user-groups/${group.unique_identifier}`\"\n                          title=\"Edit\"\n                        >\n                          <span title=\"Edit\" class=\"hover:text-white\"\n                            ><svg\n                              xmlns=\"http://www.w3.org/2000/svg\"\n                              fill=\"none\"\n                              viewBox=\"0 0 24 24\"\n                              stroke-width=\"1.5\"\n                              stroke=\"currentColor\"\n                              class=\"w-5 h-5\"\n                            >\n                              <path\n                                stroke-linecap=\"round\"\n                                stroke-linejoin=\"round\"\n                                d=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10\"\n                              />\n                            </svg>\n                          </span>\n                        </NuxtLink>\n\n                        <span\n                          @click=\"(event) => destroy(group.id, group.name)\"\n                          title=\"Delete\"\n                          class=\"hover:text-white\"\n                        >\n                          <svg\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                            fill=\"none\"\n                            viewBox=\"0 0 24 24\"\n                            stroke-width=\"1.5\"\n                            stroke=\"currentColor\"\n                            class=\"w-6 h-6\"\n                          >\n                            <path\n                              stroke-linecap=\"round\"\n                              stroke-linejoin=\"round\"\n                              d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\"\n                            />\n                          </svg>\n                        </span>\n                      </div>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { defu } from \"defu\";\nimport { Modal } from \"usemodal-vue3\";\n\ndefinePageMeta({\n  middleware: [\"auth\"],\n});\nconst config = useRuntimeConfig();\n\nconst AWN = inject(\"$awn\");\n\nconst { id } = useRoute().query;\nconst shouldShowDialog = ref(false);\nconst groups = ref([]);\n// const searchdatas = ref([]);\nconst groupsTotal = ref(0);\nconst searchdatas = ref([]);\nconst search = reactive({\n  vaClDa: \"\",\n});\n\nconst empty = () => {\n  search.vaClDa = \"\";\n  searchdatas.value = groups.value;\n  groupsTotal.value = groups.value.length;\n};\n\nconst searched = () => {\n  searchdatas.value = groups?._value?.filter((row) => {\n    return (\n      row.createdBy\n        .toLowerCase()\n        ?.includes(search.vaClDa?.toString()?.toLowerCase()) ||\n      row?.unique_identifier?.includes(search.vaClDa) ||\n      row?.name\n        ?.toLowerCase()\n        .includes(search.vaClDa?.toString()?.toLowerCase()) ||\n      row?.description\n        ?.toLowerCase()\n        ?.includes(search.vaClDa?.toString()?.toLowerCase())\n    );\n  });\n  groupsTotal.value = searchdatas.value.length;\n};\n\nconst enterSearch = () => {\n  searchdatas.value = groups?._value?.filter((row) => {\n    return (\n      row.createdBy\n        .toLowerCase()\n        ?.includes(search.vaClDa?.toString()?.toLowerCase()) ||\n      row?.unique_identifier?.includes(search.vaClDa) ||\n      row?.name\n        ?.toLowerCase()\n        .includes(search.vaClDa?.toString()?.toLowerCase()) ||\n      row?.description\n        ?.toLowerCase()\n        ?.includes(search.vaClDa?.toString()?.toLowerCase())\n    );\n  });\n  groupsTotal.value = searchdatas.value.length;\n};\n\nconst defUser = JSON.parse(localStorage.getItem(\"user\"));\nconst activeProject = ref(0);\nconst name = ref(\"\");\nconst form = reactive({\n  id: \"\",\n  user_id: \"\",\n  name: \"\",\n  description: \"\",\n});\n\nif (id) {\n  const { data: user } = await useFetch(`${config.API_BASE_URL}groups/${id}`, {\n    key: id,\n  });\n\n  form.id = user.value.id;\n  form.user_id = defUser.userId;\n  form.name = user.value.name;\n  form.description = user.value.description;\n}\n\nconst createUserGroup = async () => {\n  const a_data = {\n    user_id: defUser.userId,\n    name: form.name,\n    description: form.description,\n  };\n\n  if (form.id !== \"\") {\n    const { data, error } = await useFetch(\n      `${config.API_BASE_URL}groups/update/${form.id}`,\n      {\n        method: \"PUT\",\n        params: { id: form.id },\n        body: a_data,\n      }\n    );\n    if (data.value) {\n      form.id = \"\";\n      form.name = \"\";\n      form.description = \"\";\n\n      setGroupsData();\n\n      await AWN.success(data.value.message);\n    }\n    if (error.value) {\n      await AWN.alert(error.value.statusMessage);\n    }\n  } else {\n    await useFetch(`${config.API_BASE_URL}groups/create`, {\n      method: \"POST\",\n      body: a_data,\n    })\n      .then((result) => {\n        if (result.data.value) {\n          form.id = \"\";\n          form.name = \"\";\n          form.description = \"\";\n\n          setGroupsData();\n\n          AWN.success(result.data.value.message);\n          // navigateTo(\"/user-groups\");\n        }\n        if (result.error.value) {\n          console.log(\"Error:\", result);\n          AWN.alert(result.error.value);\n        }\n      })\n      .catch((error) => {\n        console.log(\"error\", error);\n        AWN.alert(\"Unable to save group.\");\n      });\n  }\n};\n\nconst setGroupsData = async () => {\n  if (!localStorage.getItem(\"activeProject\")) {\n    let timer = 0;\n    const waitForActiveProject = setInterval(async () => {\n      if (localStorage.getItem(\"activeProject\")) {\n        clearInterval(waitForActiveProject);\n        activeProject.value = parseInt(localStorage.getItem(\"activeProject\"));\n        const { data: data } = await useFetch(\n          `${config.API_BASE_URL}groups/all?ProjectId=${activeProject.value}`\n        );\n\n        searchdatas.value = data.value;\n        groups.value = data.value;\n        groupsTotal.value = data.value?.length;\n      } else {\n        timer += 1;\n        if (timer / 10 > 5) {\n          clearInterval(waitForActiveProject);\n        }\n      }\n    }, 100);\n  } else {\n    activeProject.value = parseInt(localStorage.getItem(\"activeProject\"));\n    const { data: data } = await useFetch(\n      `${config.API_BASE_URL}groups/all?ProjectId=${activeProject.value}`\n    );\n\n    searchdatas.value = data.value;\n    groups.value = data.value;\n    groupsTotal.value = data.value?.length;\n  }\n};\n\nconst update = async (id) => {\n  const { data: user } = await useFetch(`${config.API_BASE_URL}groups/${id}`);\n\n  form.id = user.value.id;\n  form.name = user.value.name;\n  form.description = user.value.description;\n};\n\nconst destroy = async (id, deletingName) => {\n  shouldShowDialog.value = true;\n  localStorage.setItem(\"sometraffic_delete_group\", id);\n  localStorage.setItem(\"sometraffic_delete_group_name\", deletingName);\n  name.value = deletingName;\n};\n\nconst handleDelete = async () => {\n  const id = localStorage.getItem(\"sometraffic_delete_group\");\n  const { data, error } = await useFetch(\n    `${config.API_BASE_URL}groups/delete/${id}`,\n    {\n      method: \"GET\",\n      params: { id: id },\n    }\n  );\n\n  if (data.value) {\n    shouldShowDialog.value = false;\n    await AWN.success(data.value.message);\n  }\n  if (error.value) {\n    shouldShowDialog.value = false;\n    await AWN.alert(error.value.statusMessage);\n  }\n\n  localStorage.removeItem(\"sometraffic_delete_group\");\n  await setGroupsData();\n};\n\nonBeforeMount(setGroupsData);\n</script>\n<style scoped>\n#users_groups h1,\ntable tbody tr td,\ninput {\n  color: #000 !important;\n}\n\n#users_groups input.search {\n  background: #ddd;\n}\n</style>\n\n<style>\n.modal-vue3-header,\n.modal-vue3-body .text {\n  color: #000 !important;\n}\n\n.confirm-modal > div > .modal-vue3-content {\n  /* background: red; */\n  /* display: none !important; */\n}\n</style>\n"],"names":["_a","id"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4OA,UAAA,SAAA,iBAAA;AAEA,UAAA,MAAA,OAAA,MAAA;AAEA,UAAA,EAAA,GAAA,IAAA,SAAA,EAAA;AACA,UAAA,mBAAA,IAAA,KAAA;AACA,UAAA,SAAA,IAAA,CAAA,CAAA;AAEA,UAAA,cAAA,IAAA,CAAA;AACA,UAAA,cAAA,IAAA,CAAA,CAAA;AACA,UAAA,SAAA,SAAA;AAAA,MACA,QAAA;AAAA,IACA,CAAA;AA4CA,UAAA,UAAA,KAAA,MAAA,aAAA,QAAA,MAAA,CAAA;AACA,UAAA,gBAAA,IAAA,CAAA;AACA,UAAA,OAAA,IAAA,EAAA;AACA,UAAA,OAAA,SAAA;AAAA,MACA,IAAA;AAAA,MACA,SAAA;AAAA,MACA,MAAA;AAAA,MACA,aAAA;AAAA,IACA,CAAA;AAEA,QAAA,IAAA;AACA,YAAA,EAAA,MAAA,KAAA;QACA,KAAA;AAAA,MACA,GAAA,aAAA,CAAA;AAEA,WAAA,KAAA,KAAA,MAAA;AACA,WAAA,UAAA,QAAA;AACA,WAAA,OAAA,KAAA,MAAA;AACA,WAAA,cAAA,KAAA,MAAA;AAAA,IACA;AA0DA,UAAA,gBAAA,YAAA;;AACA,UAAA,CAAA,aAAA,QAAA,eAAA,GAAA;AACA,YAAA,QAAA;AACA,cAAA,uBAAA,YAAA,YAAA;;AACA,cAAA,aAAA,QAAA,eAAA,GAAA;AACA,0BAAA,oBAAA;AACA,0BAAA,QAAA,SAAA,aAAA,QAAA,eAAA,CAAA;AACA,kBAAA,EAAA,KAAA,IAAA,MAAA;AAAA,cACA,GAAA,OAAA,oCAAA,cAAA;AAAA,cACA;AAAA,YAAA;AAEA,wBAAA,QAAA,KAAA;AACA,mBAAA,QAAA,KAAA;AACA,wBAAA,SAAAA,MAAA,KAAA,UAAA,gBAAAA,IAAA;AAAA,UACA,OAAA;AACA,qBAAA;AACA,gBAAA,QAAA,KAAA,GAAA;AACA,4BAAA,oBAAA;AAAA,YACA;AAAA,UACA;AAAA,QACA,GAAA,GAAA;AAAA,MACA,OAAA;AACA,sBAAA,QAAA,SAAA,aAAA,QAAA,eAAA,CAAA;AACA,cAAA,EAAA,KAAA,IAAA,MAAA;AAAA,UACA,GAAA,OAAA,oCAAA,cAAA;AAAA,UACA;AAAA,QAAA;AAEA,oBAAA,QAAA,KAAA;AACA,eAAA,QAAA,KAAA;AACA,oBAAA,SAAA,UAAA,UAAA,mBAAA;AAAA,MACA;AAAA,IACA;AAiBA,UAAA,eAAA,YAAA;AACA,YAAAC,MAAA,aAAA,QAAA,0BAAA;AACA,YAAA,EAAA,MAAA,MAAA,IAAA,MAAA;AAAA,QACA,GAAA,OAAA,6BAAAA;AAAA,QACA;AAAA,UACA,QAAA;AAAA,UACA,QAAA,EAAA,IAAAA,IAAA;AAAA,QACA;AAAA,QACA;AAAA,MAAA;AAEA,UAAA,KAAA,OAAA;AACA,yBAAA,QAAA;AACA,cAAA,IAAA,QAAA,KAAA,MAAA,OAAA;AAAA,MACA;AACA,UAAA,MAAA,OAAA;AACA,yBAAA,QAAA;AACA,cAAA,IAAA,MAAA,MAAA,MAAA,aAAA;AAAA,MACA;AAEA,mBAAA,WAAA,0BAAA;AACA,YAAA,cAAA;AAAA,IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
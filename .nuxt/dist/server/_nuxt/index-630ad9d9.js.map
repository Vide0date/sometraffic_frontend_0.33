{"version":3,"file":"index-630ad9d9.js","sources":["../../../../pages/users/index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div id=\"last-users\">\r\n    <Modal\r\n      title=\"You can NOT undo this action\"\r\n      modalClass=\"confirm-modal\"\r\n      v-model:visible=\"shouldShowDialog\"\r\n      :cancelButton=\"{ text: 'Cancel' }\"\r\n      :okButton=\"{ text: 'Okay', onclick: () => handleDelete() }\"\r\n    >\r\n      <div class=\"text\">Are you sure?</div>\r\n    </Modal>\r\n\r\n      <div class=\"flex justify-between\">\r\n        <h1 class=\"font-bold py-4 uppercase\">Users</h1>\r\n        <h1 class=\"pt-3 pr-4\">\r\n          <NuxtLink to=\"/users/add\">\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              fill=\"none\"\r\n              viewBox=\"0 0 24 24\"\r\n              stroke-width=\"1.5\"\r\n              stroke=\"currentColor\"\r\n              class=\"w-6 h-6\"\r\n            >\r\n              <path\r\n                stroke-linecap=\"round\"\r\n                stroke-linejoin=\"round\"\r\n                d=\"M12 4.5v15m7.5-7.5h-15\"\r\n              />\r\n            </svg>\r\n          </NuxtLink>\r\n        </h1>\r\n      </div>\r\n\r\n      <div class=\"overflow-x-auto\">\r\n        <table class=\"w-full whitespace-nowrap\">\r\n          <thead class=\"bg-black/60\">\r\n            <tr>\r\n              <th class=\"text-left py-3 px-2 rounded-l-lg\">Name</th>\r\n              <th class=\"text-left py-3 px-2\">Email</th>\r\n              <th class=\"text-left py-3 px-2\">User Type</th>\r\n              <th class=\"text-left py-3 px-2\">Account</th>\r\n              <th class=\"text-left py-3 px-2 rounded-r-lg\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr\r\n              class=\"border-b border-gray-700\"\r\n              v-for=\"user in users\"\r\n              key=\"user.id\"\r\n            >\r\n              <td class=\"py-3 px-2 font-bold\">{{ user.userName }}</td>\r\n              <td class=\"py-3 px-2\">{{ user.email }}</td>\r\n              <td class=\"py-3 px-2\">{{ user.userType }}</td>\r\n              <td class=\"py-3 px-2\">{{ getAccountName(user.AccountId) }}</td>\r\n              <td class=\"py-3 px-2\">\r\n                <div class=\"inline-flex items-center space-x-3\">\r\n                  <NuxtLink\r\n                    :to=\"`/users/${user.id}`\"\r\n                    title=\"Edit\"\r\n                    class=\"hover:text-white\"\r\n                    ><svg\r\n                      xmlns=\"http://www.w3.org/2000/svg\"\r\n                      fill=\"none\"\r\n                      viewBox=\"0 0 24 24\"\r\n                      stroke-width=\"1.5\"\r\n                      stroke=\"currentColor\"\r\n                      class=\"w-5 h-5\"\r\n                    >\r\n                      <path\r\n                        stroke-linecap=\"round\"\r\n                        stroke-linejoin=\"round\"\r\n                        d=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10\"\r\n                      />\r\n                    </svg>\r\n                  </NuxtLink>\r\n\r\n                  <span\r\n                    @click=\"(event) => destroy(user.id)\"\r\n                    title=\"Delete\"\r\n                    class=\"hover:text-white\"\r\n                  >\r\n                    <svg\r\n                      xmlns=\"http://www.w3.org/2000/svg\"\r\n                      fill=\"none\"\r\n                      viewBox=\"0 0 24 24\"\r\n                      stroke-width=\"1.5\"\r\n                      stroke=\"currentColor\"\r\n                      class=\"w-6 h-6\"\r\n                    >\r\n                      <path\r\n                        stroke-linecap=\"round\"\r\n                        stroke-linejoin=\"round\"\r\n                        d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\"\r\n                      />\r\n                    </svg>\r\n                  </span>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Modal } from \"usemodal-vue3\";\r\n// const { data: users } = await useFetch('http://localhost:1212/api/users/all')\r\ndefinePageMeta({\r\n  middleware: [\"auth\", \"admin\"],\r\n});\r\nconst user = JSON.parse(localStorage.getItem('user'))\r\nconst AWN = inject(\"$awn\");\r\n\r\nconst shouldShowDialog = ref(false);\r\nconst users = ref([]);\r\nconst accounts = ref([]);\r\nconst config = useRuntimeConfig();\r\n\r\nconst setUsers = async () => {\r\n  const { data: data } = await useFetch(`${config.API_BASE_URL}users/all`);\r\n  users.value = data.value;\r\n};\r\n\r\nconst setAccounts = async () => {\r\n  const { data: data } = await useFetch(`${config.API_BASE_URL}accounts/all`)\r\n  accounts.value = data.value\r\n}\r\n\r\nconst getAccountName = (id) => {\r\n  const account = accounts.value.find(account => account.id === id)\r\n  return account ? account.name : ''\r\n}\r\n\r\nconst handleDelete = async () => {\r\n  const id = localStorage.getItem(\"sometraffic_delete_user\");\r\n  const { data, error } = await useFetch(\r\n    `${config.API_BASE_URL}users/delete/${id}`,\r\n    {\r\n      method: \"GET\",\r\n      params: { id: id },\r\n    }\r\n  );\r\n  if (data.value) {\r\n    shouldShowDialog.value = false;\r\n    await AWN.success(data.value.message);\r\n  }\r\n  if (error.value) {\r\n    shouldShowDialog.value = false;\r\n    await AWN.alert(error.value.statusMessage);\r\n  }\r\n\r\n  localStorage.removeItem(\"sometraffic_delete_user\");\r\n  await setUsers();\r\n};\r\n\r\nconst destroy = async (id) => {\r\n  shouldShowDialog.value = true;\r\n  localStorage.setItem(\"sometraffic_delete_user\", id);\r\n};\r\n\r\nonBeforeMount(setUsers);\r\nonBeforeMount(setAccounts);\r\n// onMounted(setUsers)\r\n</script>\r\n\r\n<style scoped></style>"],"names":["account"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAkHA,SAAA,MAAA,aAAA,QAAA,MAAA,CAAA;AACA,UAAA,MAAA,OAAA,MAAA;AAEA,UAAA,mBAAA,IAAA,KAAA;AACA,UAAA,QAAA,IAAA,CAAA,CAAA;AACA,UAAA,WAAA,IAAA,CAAA,CAAA;AACA,UAAA,SAAA,iBAAA;AAEA,UAAA,WAAA,YAAA;AACA,YAAA,EAAA,KAAA,IAAA,MAAA,SAAA,GAAA,OAAA,yBAAA,aAAA;AACA,YAAA,QAAA,KAAA;AAAA,IACA;AAOA,UAAA,iBAAA,CAAA,OAAA;AACA,YAAA,UAAA,SAAA,MAAA,KAAA,CAAAA,aAAAA,SAAA,OAAA,EAAA;AACA,aAAA,UAAA,QAAA,OAAA;AAAA,IACA;AAEA,UAAA,eAAA,YAAA;AACA,YAAA,KAAA,aAAA,QAAA,yBAAA;AACA,YAAA,EAAA,MAAA,MAAA,IAAA,MAAA;AAAA,QACA,GAAA,OAAA,4BAAA;AAAA,QACA;AAAA,UACA,QAAA;AAAA,UACA,QAAA,EAAA,GAAA;AAAA,QACA;AAAA,QACA;AAAA,MAAA;AACA,UAAA,KAAA,OAAA;AACA,yBAAA,QAAA;AACA,cAAA,IAAA,QAAA,KAAA,MAAA,OAAA;AAAA,MACA;AACA,UAAA,MAAA,OAAA;AACA,yBAAA,QAAA;AACA,cAAA,IAAA,MAAA,MAAA,MAAA,aAAA;AAAA,MACA;AAEA,mBAAA,WAAA,yBAAA;AACA,YAAA,SAAA;AAAA,IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
{"version":3,"file":"index-9dc93bf1.js","sources":["../../../../pages/projects/index.vue"],"sourcesContent":["<template>\r\n  <div id=\"users_projects\">\r\n    <Modal\r\n      title=\"You can NOT undo this action\"\r\n      modalClass=\"confirm-modal\"\r\n      v-model:visible=\"shouldShowDialog\"\r\n      :cancelButton=\"{ text: 'Cancel' }\"\r\n      :okButton=\"{ text: 'Okay', onclick: () => handleDelete() }\"\r\n    >\r\n      <div class=\"text\">Are you sure you want to delete {{ name }}?</div>\r\n    </Modal>\r\n    <div class=\"flex justify-between\">\r\n      <h1 class=\"font-bold py-4 capitalize\">Projects ({{ projectsTotal }})</h1>\r\n      <div class=\"flex items-start\">\r\n        <div class=\"flex border-2 rounded\">\r\n          <div class=\"relative\">\r\n            <input\r\n              type=\"text\"\r\n              v-model=\"search.vaClDa\"\r\n              class=\"px-4 py-2 w-80 border-inherit bg-inherit pr-9 focus:outline-none focus:ring focus:border-blue-600 search\"\r\n              placeholder=\"Search...\"\r\n              v-on:keyup.enter=\"enterSearch()\"\r\n            />\r\n            <!-- <div class=\"absolute inset-y-0 right-0\"> -->\r\n            <button\r\n              class=\"absolute inset-y-0 right-0 px-2\"\r\n              @click=\"(event) => empty()\"\r\n            >\r\n              <svg\r\n                color=\"black\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke-width=\"1.5\"\r\n                stroke=\"currentColor\"\r\n                class=\"w-6 h-6\"\r\n              >\r\n                <path\r\n                  stroke-linecap=\"round\"\r\n                  stroke-linejoin=\"round\"\r\n                  d=\"M6 18L18 6M6 6l12 12\"\r\n                />\r\n              </svg>\r\n            </button>\r\n            <!-- </div> -->\r\n          </div>\r\n\r\n          <button\r\n            class=\"flex items-center justify-center px-4 border-l bg-blue-700\"\r\n            @click=\"(event) => searched()\"\r\n          >\r\n            <svg\r\n              class=\"w-6 h-6 text-slate-50\"\r\n              fill=\"currentColor\"\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                d=\"M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z\"\r\n              />\r\n            </svg>\r\n          </button>\r\n          <button\r\n            class=\"flex items-center justify-center px-4 border-l border-grey-600 bg-grey-700\"\r\n            @click=\"navigateTo('/projects/add')\"\r\n          >\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              fill=\"none\"\r\n              viewBox=\"0 0 24 24\"\r\n              stroke-width=\"1.5\"\r\n              stroke=\"currentColor\"\r\n              class=\"w-6 h-6\"\r\n            >\r\n              <path\r\n                stroke-linecap=\"round\"\r\n                stroke-linejoin=\"round\"\r\n                d=\"M12 4.5v15m7.5-7.5h-15\"\r\n              />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"overflow-hidden shadow sm:rounded-md\">\r\n      <div class=\"px-4 py-5 sm:p-6\">\r\n        <div class=\"grid grid-cols-12\">\r\n          <!-- <div class=\"col-span-12\">\r\n              <form @submit.prevent=\"createUserGroup\">\r\n                <div class=\"grid\">\r\n                  <div class=\"col-span-12\">\r\n                    <div class=\"grid grid-cols-12\">\r\n                      <div\r\n                        class=\"col-span-3 w-fit flex items-center text-sm font-medium text-gray-700\"\r\n                      >\r\n                        Name\r\n                      </div>\r\n                      <div class=\"col-span-9 px-1.5\">\r\n                        <input\r\n                          type=\"text\"\r\n                          v-model=\"form.name\"\r\n                          id=\"name\"\r\n                          maxlength=\"100\"\r\n                          class=\"bg-[#dddddd] h-10 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n  \r\n                    <div class=\"grid grid-cols-12\">\r\n                      <div\r\n                        class=\"col-span-3 flex items-center text-sm font-medium text-gray-700\"\r\n                      >\r\n                        Description\r\n                      </div>\r\n                      <div class=\"col-span-9 px-1.5\">\r\n                        <textarea\r\n                          v-model=\"form.description\"\r\n                          id=\"description\"\r\n                          rows=\"6\"\r\n                          maxlength=\"500\"\r\n                          class=\"bg-[#dddddd] h-20 py-2 px-3 text-gray-900 mt-1 w-full rounded-md border-gray-300 shadow-sm focus:border-gray-800 focus:ring-indigo-500 sm:text-sm\"\r\n                        ></textarea>\r\n                      </div>\r\n                    </div>\r\n  \r\n                    <div class=\"px-2 py-3 text-right sm:px-2 w-full sm:w-full\">\r\n                      <button\r\n                        type=\"submit\"\r\n                        class=\"bg-[#bcbcbc] inline-flex justify-end rounded-md border border-transparent py-2 px-4 text-sm font-medium text-black shadow-sm hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\"\r\n                      >\r\n                        Submit\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div> -->\r\n          <div class=\"col-span-12\">\r\n            <div class=\"overflow-x-auto\">\r\n              <table class=\"w-full whitespace-nowrap\">\r\n                <thead class=\"bg-black/60\">\r\n                  <tr>\r\n                    <th class=\"text-left py-3 px-2 rounded-l-lg\">Item ID</th>\r\n                    <th class=\"text-left py-3 px-2\">Name</th>\r\n                    <th class=\"text-left py-3 px-2\">Description</th>\r\n                    <th class=\"text-left py-3 px-2 rounded-r-lg\">Actions</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr\r\n                    class=\"border-b border-gray-700\"\r\n                    v-for=\"project in searchdatas\"\r\n                    :key=\"project.id\"\r\n                  >\r\n                    <td class=\"py-3 px-2\">\r\n                      <NuxtLink\r\n                        :to=\"`/projects/${project.unique_identifier}`\"\r\n                        title=\"Edit\"\r\n                        class=\"hover:text-white\"\r\n                      >\r\n                        {{ project?.unique_identifier }}\r\n                      </NuxtLink>\r\n                    </td>\r\n                    <td class=\"py-3 px-2\">{{ project.name }}</td>\r\n                    <td class=\"py-3 px-2\">\r\n                      {{\r\n                        project.description?.length > 100\r\n                          ? project.description.slice(0, 100) + \"...\"\r\n                          : project.description\r\n                      }}\r\n                    </td>\r\n                    <td class=\"py-3 px-2\">\r\n                      <div class=\"inline-flex items-center space-x-3\">\r\n                        <NuxtLink\r\n                          :to=\"`/projects/${project.unique_identifier}`\"\r\n                          title=\"Edit\"\r\n                        >\r\n                          <span title=\"Edit\" class=\"hover:text-white\"\r\n                            ><svg\r\n                              xmlns=\"http://www.w3.org/2000/svg\"\r\n                              fill=\"none\"\r\n                              viewBox=\"0 0 24 24\"\r\n                              stroke-width=\"1.5\"\r\n                              stroke=\"currentColor\"\r\n                              class=\"w-5 h-5\"\r\n                            >\r\n                              <path\r\n                                stroke-linecap=\"round\"\r\n                                stroke-linejoin=\"round\"\r\n                                d=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10\"\r\n                              />\r\n                            </svg>\r\n                          </span>\r\n                        </NuxtLink>\r\n\r\n\r\n                        <span\r\n                          @click=\"(event) => destroy(project.id, project.name)\"\r\n                          title=\"Delete\"\r\n                          class=\"hover:text-white\"\r\n                        >\r\n                          <svg\r\n                            xmlns=\"http://www.w3.org/2000/svg\"\r\n                            fill=\"none\"\r\n                            viewBox=\"0 0 24 24\"\r\n                            stroke-width=\"1.5\"\r\n                            stroke=\"currentColor\"\r\n                            class=\"w-6 h-6\"\r\n                          >\r\n                            <path\r\n                              stroke-linecap=\"round\"\r\n                              stroke-linejoin=\"round\"\r\n                              d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\"\r\n                            />\r\n                          </svg>\r\n                        </span>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { defu } from \"defu\"\r\nimport { Modal } from \"usemodal-vue3\"\r\n\r\ndefinePageMeta({\r\n  middleware: [\"auth\"],\r\n})\r\nconst config = useRuntimeConfig()\r\n\r\nconst AWN = inject(\"$awn\")\r\n\r\nconst { id } = useRoute().query\r\nconst shouldShowDialog = ref(false)\r\nconst projects = ref([])\r\n// const searchdatas = ref([]);\r\nconst projectsTotal = ref(0)\r\nconst searchdatas = ref([])\r\nconst search = reactive({\r\n  vaClDa: \"\",\r\n})\r\nconst activeAccount = ref(\r\n  localStorage.getItem(\"activeAccount\")\r\n)\r\n\r\nconst empty = () => {\r\n  search.vaClDa = \"\"\r\n  searchdatas.value = projects.value\r\n  projectsTotal.value = projects.value.length\r\n}\r\n\r\nconst searched = () => {\r\n  searchdatas.value = projects?._value?.filter((row) => {\r\n    return (\r\n      row.name\r\n        .toLowerCase()\r\n        ?.includes(search.vaClDa?.toString()?.toLowerCase()) ||\r\n        row?.description\r\n          ?.toLowerCase()\r\n          ?.includes(search.vaClDa?.toString()?.toLowerCase()) ||\r\n      row?.unique_identifier?.includes(search.vaClDa) ||\r\n      row?.createdBy\r\n        ?.toLowerCase()\r\n        .includes(search.vaClDa?.toString()?.toLowerCase())\r\n    )\r\n  })\r\n  projectsTotal.value = searchdatas.value.length\r\n}\r\n\r\nconst enterSearch = () => {\r\n  searchdatas.value = projects?._value?.filter((row) => {\r\n    return (\r\n      row.name\r\n        .toLowerCase()\r\n        ?.includes(search.vaClDa?.toString()?.toLowerCase()) ||\r\n        row?.description\r\n          ?.toLowerCase()\r\n          ?.includes(search.vaClDa?.toString()?.toLowerCase()) ||\r\n      row?.unique_identifier?.includes(search.vaClDa) ||\r\n      row?.createdBy\r\n        ?.toLowerCase()\r\n        .includes(search.vaClDa?.toString()?.toLowerCase())\r\n    )\r\n  })\r\n  projectsTotal.value = searchdatas.value.length\r\n}\r\n\r\nconst defUser = JSON.parse(localStorage.getItem(\"user\"))\r\nconst name = ref(localStorage.getItem(\"sometraffic_delete_project_name\"))\r\nconst form = reactive({\r\n  id: \"\",\r\n  user_id: \"\",\r\n  name: \"\",\r\n  description: \"\",\r\n})\r\n\r\nif (id) {\r\n  const { data: project } = await useFetch(\r\n    `${config.API_BASE_URL}projects/${id}`,\r\n    {\r\n      key: id,\r\n    }\r\n  )\r\n\r\n  form.id = project.value.id\r\n  form.user_id = defUser.userId\r\n  form.name = project.value.name\r\n  form.description = project.value.description\r\n}\r\n\r\nconst setProjects = async () => {\r\n  const { data: data } = await useFetch(\r\n    `${config.API_BASE_URL}projects/all?AccountId=${activeAccount.value}`\r\n  )\r\n  searchdatas.value = data.value\r\n  projects.value = data.value\r\n  projectsTotal.value = data.value?.length\r\n}\r\n\r\nconst update = async (id) => {\r\n  const { data: project } = await useFetch(`${config.API_BASE_URL}projects/${id}`)\r\n\r\n  form.id = project.value.id\r\n  form.name = project.value.name\r\n  form.description = project.value.description\r\n}\r\n\r\nconst destroy = async (id, deletingName) => {\r\n  shouldShowDialog.value = true\r\n  localStorage.setItem(\"sometraffic_delete_project\", id)\r\n  localStorage.setItem(\"sometraffic_delete_project_name\", deletingName)\r\n  name.value = deletingName\r\n}\r\n\r\nconst handleDelete = async () => {\r\n  const id = localStorage.getItem(\"sometraffic_delete_project\")\r\n  const { data, error } = await useFetch(\r\n    `${config.API_BASE_URL}projects/delete/${id}`,\r\n    {\r\n      method: \"GET\",\r\n      params: { id: id },\r\n    }\r\n  )\r\n\r\n  if (data.value) {\r\n    shouldShowDialog.value = false\r\n    await AWN.success(data.value.message)\r\n    const activeProject = localStorage.getItem('activeProject')\r\n    if(activeProject === id)\r\n    localStorage.removeItem('activeProject')\r\n    const router = useRouter()\r\n          router.go(\"/projects\")\r\n  }\r\n  if (error.value) {\r\n    shouldShowDialog.value = false\r\n    await AWN.alert(error.value.statusMessage)\r\n  }\r\n\r\n  localStorage.removeItem(\"sometraffic_delete_project\")\r\n  await setProjects()\r\n}\r\n\r\nonBeforeMount(setProjects)\r\n</script>\r\n<style scoped>\r\n#users_projects h1,\r\ntable tbody tr td,\r\ninput {\r\n  color: #000 !important;\r\n}\r\n\r\n#users_projects input.search {\r\n  background: #ddd;\r\n}\r\n</style>\r\n\r\n<style>\r\n.modal-vue3-header,\r\n.modal-vue3-body .text {\r\n  color: #000 !important;\r\n}\r\n\r\n.confirm-modal > div > .modal-vue3-content {\r\n  /* background: red; */\r\n  /* display: none !important; */\r\n}\r\n</style>\r\n"],"names":["id"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4OA,UAAA,SAAA,iBAAA;AAEA,UAAA,MAAA,OAAA,MAAA;AAEA,UAAA,EAAA,GAAA,IAAA,SAAA,EAAA;AACA,UAAA,mBAAA,IAAA,KAAA;AACA,UAAA,WAAA,IAAA,EAAA;AAEA,UAAA,gBAAA,IAAA,CAAA;AACA,UAAA,cAAA,IAAA,EAAA;AACA,UAAA,SAAA,SAAA;AAAA,MACA,QAAA;AAAA,IACA,CAAA;AACA,UAAA,gBAAA;AAAA,MACA,aAAA,QAAA,eAAA;AAAA,IACA;AA4CA,UAAA,UAAA,KAAA,MAAA,aAAA,QAAA,MAAA,CAAA;AACA,UAAA,OAAA,IAAA,aAAA,QAAA,iCAAA,CAAA;AACA,UAAA,OAAA,SAAA;AAAA,MACA,IAAA;AAAA,MACA,SAAA;AAAA,MACA,MAAA;AAAA,MACA,aAAA;AAAA,IACA,CAAA;AAEA,QAAA,IAAA;AACA,YAAA,EAAA,MAAA,QAAA;QACA,GAAA,OAAA,wBAAA;AAAA,QACA;AAAA,UACA,KAAA;AAAA,QACA;AAAA,QACA;AAAA,MAAA,CAAA;AAEA,WAAA,KAAA,QAAA,MAAA;AACA,WAAA,UAAA,QAAA;AACA,WAAA,OAAA,QAAA,MAAA;AACA,WAAA,cAAA,QAAA,MAAA;AAAA,IACA;AAEA,UAAA,cAAA,YAAA;;AACA,YAAA,EAAA,KAAA,IAAA,MAAA;AAAA,QACA,GAAA,OAAA,sCAAA,cAAA;AAAA,QACA;AAAA,MAAA;AACA,kBAAA,QAAA,KAAA;AACA,eAAA,QAAA,KAAA;AACA,oBAAA,SAAA,UAAA,UAAA,mBAAA;AAAA,IACA;AAiBA,UAAA,eAAA,YAAA;AACA,YAAAA,MAAA,aAAA,QAAA,4BAAA;AACA,YAAA,EAAA,MAAA,MAAA,IAAA,MAAA;AAAA,QACA,GAAA,OAAA,+BAAAA;AAAA,QACA;AAAA,UACA,QAAA;AAAA,UACA,QAAA,EAAA,IAAAA,IAAA;AAAA,QACA;AAAA,QACA;AAAA,MAAA;AAEA,UAAA,KAAA,OAAA;AACA,yBAAA,QAAA;AACA,cAAA,IAAA,QAAA,KAAA,MAAA,OAAA;AACA,cAAA,gBAAA,aAAA,QAAA,eAAA;AACA,YAAA,kBAAAA;AACA,uBAAA,WAAA,eAAA;AACA,cAAA,SAAA,UAAA;AACA,eAAA,GAAA,WAAA;AAAA,MACA;AACA,UAAA,MAAA,OAAA;AACA,yBAAA,QAAA;AACA,cAAA,IAAA,MAAA,MAAA,MAAA,aAAA;AAAA,MACA;AAEA,mBAAA,WAAA,4BAAA;AACA,YAAA,YAAA;AAAA,IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
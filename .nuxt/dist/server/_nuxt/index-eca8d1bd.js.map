{"version":3,"file":"index-eca8d1bd.js","sources":["../../../../pages/admin-settings/index.vue"],"sourcesContent":["<template>\n    <div class=\"flex flex-col\">\n        <div class=\"flex mb-4\">\n            <h1 class=\"font-bold\">Admin settings</h1>\n        </div>\n        <hr>\n        <div class=\"flex flex-col mt-4 p-8 gap-y-4\">\n            <label for=\"download\">Backup database</label>\n            <hr class=\"border-gray-300\">\n            <button name=\"download\" class=\"mb-8 text-black cursor-pointer w-fit px-4 py-2 rounded-md bg-gray-400 hover:bg-gray-600 transition\" @click=\"downloadDb()\"\n                >Download Database</button\n              >\n              <label>Account</label>\n            <hr class=\"border-gray-300\">\n              <div class=\"flex mb-8\">\n                <label for=\"account\" class=\"mr-8 text-center self-center\">Select account to use</label>\n                <select @change=\"setActiveAccount\" name=\"account\" id=\"\" v-model=\"activeAccount\" class=\"rounded-md px-4 text-black\">\n                    <option v-for=\"account in accounts\" :key=\"account.id\" :value=\"account.id\">{{account.name}}</option>\n                </select>\n                  <nuxt-link to=\"accounts/\" class=\"ml-28 text-black cursor-pointer w-fit px-4 py-2 rounded-md bg-gray-400 hover:bg-gray-600 transition\"\n                  >Manange accounts</nuxt-link\n                  >\n                  <nuxt-link to=\"accounts/add\" class=\"ml-28 text-black cursor-pointer w-fit px-4 py-2 rounded-md bg-gray-400 hover:bg-gray-600 transition\"\n                  >Create new account</nuxt-link\n                  >\n                </div>\n                <label>Emails</label>\n            <hr class=\"border-gray-300\">\n            <nuxt-link to=\"emails\" class=\"text-black cursor-pointer w-fit px-4 py-2 rounded-md bg-gray-400 hover:bg-gray-600 transition\"\n                >Emails settings</nuxt-link\n              >\n\n        </div>\n\n    </div>\n</template>\n<script setup>\ndefinePageMeta({\n  middleware: [\"admin\"],\n});\n\nimport moment from \"moment-timezone\";\n\nconst config = useRuntimeConfig();\nconst db_name = moment(new Date()).format(\"YYYY-MM-DD-HH_mm\");\nconst full_db_name = `sometraffic-${db_name}`;\nconst AWN = inject(\"$awn\");\nconst accounts = ref([])\nconst activeAccount = ref(localStorage.getItem('activeAccount'))\n\nconst setAccounts = async () => {\n  const { data: data } = await useFetch(`${config.API_BASE_URL}accounts/all`)\n  accounts.value = data.value\n}\n\n\n\nconst downloadDb = () => {\n  const link = document.createElement(\"a\");\n  link.href = `${config.API_BASE_URL}files/sometraffic.sql`;\n  link.download = full_db_name;\n  link.target = \"_blank\";\n  link.click();\n};\n\nconst setActiveAccount = (e) => {\n    const id = e.target.value\n    const accountName = e.target.selectedOptions[0].innerText\n    const activeAccount = accounts.value.find(account => account.id === parseInt(id)) \n    localStorage.removeItem('activeProject')\n    localStorage.setItem('activeAccount', activeAccount.id)\n    AWN.success(`Active account changed to ${accountName}`);\n    const router = useRouter()\n    router.go()\n}\nonMounted(setAccounts)\n\n</script>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AA2CA,qBAAA;AACA,WAAA,IAAA,KAAA,CAAA,EAAA,OAAA,kBAAA;AAEA,WAAA,MAAA;AACA,UAAA,WAAA,IAAA,EAAA;AACA,QAAA,aAAA,QAAA,eAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}
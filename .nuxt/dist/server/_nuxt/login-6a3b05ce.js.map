{"version":3,"file":"login-6a3b05ce.js","sources":["../../../../pages/login.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"flex justify-center w-screen items-center\">\n            <div v-if=\"hasError\" class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative w-2/6 mb-6\"\n            role=\"alert\">\n                <strong class=\"font-bold\">Oops, try again! </strong>\n                <span class=\"block sm:inline\">{{ errorMessage }}</span>\n                <span class=\"absolute top-0 bottom-0 right-0 px-4 py-3\">\n                    <svg class=\"fill-current h-6 w-6 text-red-500\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\">\n                    <title>Close</title>\n                    <path\n                        d=\"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z\" />\n                    </svg>\n                </span>\n            </div>\n        </div>\n        \n        <!-- component -->\n        <form v-on:submit.prevent>\n            <div class=\"flex justify-center h-screen w-screen items-center\">\n               \n                <div class=\"w-full md:w-1/2 flex flex-col items-center \" >\n                    <!-- text login -->\n                    <h1 class=\"text-center text-2xl font-bold text-gray-600 mb-6\">Member's Login</h1>\n                     \n                    <!-- email input -->\n                    <div class=\"w-3/4 mb-6\">\n                        <input type=\"email\" v-model=\"form.email\" id=\"email\" class=\"w-full py-4 px-8  text-black bg-slate-200 placeholder:font-semibold rounded hover:ring-1 outline-blue-500\" placeholder=\"Your Email\" required>\n                    </div>\n                    <!-- password input -->\n                    <div class=\"w-3/4 mb-6\">\n                        <input type=\"password\" v-model=\"form.password\" id=\"password\" class=\"w-full py-4 px-8 text-black bg-slate-200 placeholder:font-semibold rounded hover:ring-1 outline-blue-500 \" placeholder=\"Password\" required>\n                    </div>\n                    <!-- button -->\n                    <div class=\"w-3/4 mt-4\">\n                        <button @click.prevent=\"loginForm\" class=\"py-4 bg-blue-400 w-full rounded text-blue-50 font-bold hover:bg-blue-700\"> Sign in</button>\n                    </div>\n                </div>\n            </div>\n        </form>\n    </div>\n</template>\n\n<script setup>\n    definePageMeta({\n        middleware: ['guest'],\n        layout: 'auth',\n    })\n    console.log('login');\n    const hasError = ref(null)\n    const errorMessage = ref(null)\n    const form = reactive({\n        email: '',\n        password: '',\n    });\n    const loginForm = async () => {\n        let login_data = {email: form.email, password: form.password}\n        console.log('login form submited', login_data);\n        const {data, error}=await useFetch(`${config.API_BASE_URL}auth/signin`, {\n            key: login_data.email,\n            method: 'POST',\n            body: login_data\n        })\n        if(data.value){\n            hasError.value=false\n            localStorage.setItem(\"user\", JSON.stringify(data.value))\n            localStorage.setItem(\"authToken\", data.value.accessToken);\n            if(data.value.userType === 'Administrator'){\n                console.log('admin');\n            }else {\n                console.log('not admin');\n                localStorage.setItem(\"activeAccount\", data.value.AccountId)\n            }\n            navigateTo('/')\n        }\n        if(error.value){\n            hasError.value=true\n            let err_code = error.value.statusCode\n            errorMessage.value=err_code==404?\"You didn't have any account\":err_code==401?\"Email or Password incorrect!\":error.value.statusMessage;\n            console.log('response error', error.value.statusMessage);\n        }\n    }\n \n</script>\n\n<style scoped>\n\n</style>\n    \n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAgDA,YAAA,IAAA,OAAA;AACA,UAAA,WAAA,IAAA,IAAA;AACA,UAAA,eAAA,IAAA,IAAA;AACA,UAAA,OAAA,SAAA;AAAA,MACA,OAAA;AAAA,MACA,UAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;"}
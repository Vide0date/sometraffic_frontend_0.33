{"version":3,"file":"login-6a3b05ce.js","sources":["../../../../pages/login.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"flex justify-center w-screen items-center\">\r\n            <div v-if=\"hasError\" class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative w-2/6 mb-6\"\r\n            role=\"alert\">\r\n                <strong class=\"font-bold\">Oops, try again! </strong>\r\n                <span class=\"block sm:inline\">{{ errorMessage }}</span>\r\n                <span class=\"absolute top-0 bottom-0 right-0 px-4 py-3\">\r\n                    <svg class=\"fill-current h-6 w-6 text-red-500\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\">\r\n                    <title>Close</title>\r\n                    <path\r\n                        d=\"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z\" />\r\n                    </svg>\r\n                </span>\r\n            </div>\r\n        </div>\r\n        \r\n        <!-- component -->\r\n        <form v-on:submit.prevent>\r\n            <div class=\"flex justify-center h-screen w-screen items-center\">\r\n               \r\n                <div class=\"w-full md:w-1/2 flex flex-col items-center \" >\r\n                    <!-- text login -->\r\n                    <h1 class=\"text-center text-2xl font-bold text-gray-600 mb-6\">Member's Login</h1>\r\n                     \r\n                    <!-- email input -->\r\n                    <div class=\"w-3/4 mb-6\">\r\n                        <input type=\"email\" v-model=\"form.email\" id=\"email\" class=\"w-full py-4 px-8  text-black bg-slate-200 placeholder:font-semibold rounded hover:ring-1 outline-blue-500\" placeholder=\"Your Email\" required>\r\n                    </div>\r\n                    <!-- password input -->\r\n                    <div class=\"w-3/4 mb-6\">\r\n                        <input type=\"password\" v-model=\"form.password\" id=\"password\" class=\"w-full py-4 px-8 text-black bg-slate-200 placeholder:font-semibold rounded hover:ring-1 outline-blue-500 \" placeholder=\"Password\" required>\r\n                    </div>\r\n                    <!-- button -->\r\n                    <div class=\"w-3/4 mt-4\">\r\n                        <button @click.prevent=\"loginForm\" class=\"py-4 bg-blue-400 w-full rounded text-blue-50 font-bold hover:bg-blue-700\"> Sign in</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    definePageMeta({\r\n        middleware: ['guest'],\r\n        layout: 'auth',\r\n    })\r\n    console.log('login');\r\n    const hasError = ref(null)\r\n    const errorMessage = ref(null)\r\n    const form = reactive({\r\n        email: '',\r\n        password: '',\r\n    });\r\n    const loginForm = async () => {\r\n        let login_data = {email: form.email, password: form.password}\r\n        console.log('login form submited', login_data);\r\n        const {data, error}=await useFetch(`${config.API_BASE_URL}auth/signin`, {\r\n            key: login_data.email,\r\n            method: 'POST',\r\n            body: login_data\r\n        })\r\n        if(data.value){\r\n            hasError.value=false\r\n            localStorage.setItem(\"user\", JSON.stringify(data.value))\r\n            localStorage.setItem(\"authToken\", data.value.accessToken);\r\n            if(data.value.userType === 'Administrator'){\r\n                console.log('admin');\r\n            }else {\r\n                console.log('not admin');\r\n                localStorage.setItem(\"activeAccount\", data.value.AccountId)\r\n            }\r\n            navigateTo('/')\r\n        }\r\n        if(error.value){\r\n            hasError.value=true\r\n            let err_code = error.value.statusCode\r\n            errorMessage.value=err_code==404?\"You didn't have any account\":err_code==401?\"Email or Password incorrect!\":error.value.statusMessage;\r\n            console.log('response error', error.value.statusMessage);\r\n        }\r\n    }\r\n \r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n    \r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAgDA,YAAA,IAAA,OAAA;AACA,UAAA,WAAA,IAAA,IAAA;AACA,UAAA,eAAA,IAAA,IAAA;AACA,UAAA,OAAA,SAAA;AAAA,MACA,OAAA;AAAA,MACA,UAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;"}